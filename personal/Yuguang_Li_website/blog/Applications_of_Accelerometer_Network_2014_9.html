<!DOCTYPE html>
<html lang="en">
    <head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Yuguang Li's website</title>
        <meta name="author" content="Yuguang Li">
        <meta name="description" content="The blog of Yuguang Li">
        <link rel="canonical" href="blog/project_blog.html">
        <link rel="shortcut icon" href="../assets/img/shortcut.ico">
<!--         <link href="../assets/css/head.css" rel="stylesheet" type="text/css"> -->
        <link rel="stylesheet" href="../assets/css/all.css" type="text/css">
        <link rel="stylesheet" href="../assets/css/docs.css" type="text/css">
        <link rel="stylesheet" href="../assets/css/bootstrap.min.css" type="text/css">
        <link rel="stylesheet" href="../assets/css/bootstrap-responsive.css">
        <script type="text/javascript" async="" src="../assets/js/ga.js"></script>
        <script type="text/javascript" src="../assets/js/jquery-1.7.2.min.js"></script>
        <script type="text/javascript" src="../assets/js/d3.v3.min.js" charset="utf-8"></script>
        <script type="text/javascript" src="../assets/js/bootstrap.js"></script>
<!-- /*        <script type="text/javascript" async="" src="../assets/js/embed.js"></script>*/ -->
        <style>
          table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
                        }
          th, td {
            padding: 5px;
            text-align: center;
                  }
          </style>

                  <script type="text/x-mathjax-config">
    // <![CDATA[
        MathJax.Hub.Config({ 
            TeX: {extensions: ["AMSmath.js", "AMSsymbols.js"]},     
            extensions: ["tex2jax.js"],
            jax: ["input/TeX", "output/HTML-CSS"],
            showProcessingMessages : false,
            messageStyle : "none" ,    
            showMathMenu: false ,
            tex2jax: {
            processEnvironments: true,
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            preview : "none",
            processEscapes: true
        },
        "HTML-CSS": { linebreaks: { automatic:true, width: "latex-container"} }
    });
    // ]]>
        </script>
        <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    </head>

    <body>

        <div class="container-fluid">
            <div class="row-fluid">
                <div id="sidebar-affix" class="span2 bs-docs-sidebar sidebar  ">
                    <div class="well bs-docs-sidenav affix">


    <div class="row-fluid">
        <div class="span12">
            <a class="brand" href="../index.html"> <img src="../assets/img/bigq.png" id="logo" alt="yl_logo"> </a>
        </div>
    </div> 

  <h3><center><a href="../index.html">Yuguang Li</a><center></h3>
  <hr>
  <ul class="nav nav-list">
    <div class="welcome">
      <p>
    Hi!
    <br>
    I'm Yuguang Li and I like
    <br>
    {creation, maths, coding}
    <br>
    <br>
<!--     I'm a {Web developer, Researcher} -->
    I'm a {Software Engineer, Researcher}
    <br>
    and this is my <a target="_blank" title="Yuguang's resume" href="../assets/cv/cv_YuguangLi_version1.3.pdf" onclick="_gaq.push([&#39;_trackEvent&#39;, sidebar&#39;, &#39;click&#39;, &#39;cv&#39;]);">Résumé</a>.
      </p>
    </div>
  </ul>

  <hr>
  
  <div class="row-fluid">
    <div class="span12" id="social">
      <div id="soocial">

  <a target="_blank" title="Yuguang on google plus" id="Yuguang Li on google+" href="https://plus.google.com/u/0/117045592302952581557" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;social&#39;, &#39;click&#39;, googleplus&#39;]);">
    <i class="icon-google-plus-sign"></i>
  </a>

  
  <a target="_blank" title="Yuguang Li on Github" href="https://github.com/BigQNo2" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;social&#39;, &#39;click&#39;, github&#39;]);">
    <i class="icon-github-sign"></i>
  </a>
  
 <a target="_blank" title="Yuguang Li on Linkedin" href="https://www.linkedin.com/pub/yuguang-li/92/a28/130" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;social&#39;, &#39;click&#39;, linkedin&#39;]);">
    <i class="icon-linkedin-sign"></i>
  </a>
  
  <a target="_blank" title="leeygx@bu.edu email" href="mailto:leeygx@bu.edu" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;social&#39;, &#39;click&#39;, email&#39;]);">
    <i class="icon-envelope-alt"></i>
  </a>
  
  <a target="_blank" title="Yuguang Li on google scholar" href="http://scholar.google.com/citations?user=PrEhNVQAAAAJ&hl=en" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;social&#39;, &#39;click&#39;, googlescholar&#39;]);">
    <i class="icon-graduation-cap"></i>
  </a>

</div>

    </div>
  </div>

</div>

</div>

<div class="span6 seven columns content bs-docs-container ">

<p class="meta">
  Sep 2014
  <a href="../index.html">
    <i class="home icon-home"></i>
  </a>
</p>
<h1 class="title">Motion Curves Detection by TinyOS/motes</h1>

<div id="post">
<blockquote>
<p>A TinyOS mote is consist of a MTS400 sensor board, a MicaZ mote and a MIB520 gateway, programming in NesC(kind of Lite-weighted C for embeded system). Really really love these little toys with which I could apply my creation and imagination to build something interesting. </p>
</blockquote>
<hr>

<h3 id="Motivation">Motivation</h3>
<p>Motion Capture as a famous technology is extensive used in military, entertainment, sports, and medical applications, and for validation of computer vision and robotics. In filmmaking, it refers to recording actions of human actors, and using that information to animate digital character models in 2D or 3D computer animation.
</p>

<p>
A wireless Sensor Network (WSNET) system based on TinyOS consists of spatially distributed autonomous sensors to monitor physical or environmental conditions, such as temperature, sound, vibration, pressure, motion or pollutants and to cooperatively pass their data through the network to a main location. SNET has some characteristics such as small size, ease to use, good ability to withstand harsh environmental conditions and mobility of nodes.
</p>
<hr>

<h3 id="Introduction">Introduction</h3>
<p>In this blog, I will introduce my teammates' and my efforts to exploit the accelerators on TinyOS motes for motion curve.</p>

<p>Since the sensor can collect the acceleration raw data, we design and build up a wireless sensor network with multiple motes, basement and display client. The WSNET can accomplish some basic applications such as gradientor, motion curve capture and motion period detection according to the Dual-axis Accelerometer data. Each mote senses accelerator data, calculates and pack with mode ID, velocity, calibration acceleration and displacement position.</p>

<p>All the calculation will finish by the mote itself. It improves the mobility of motes to other environments and improves the performance of display client, especially when the WSNET is a really big and complicated  network. However, it also requires the algorithm we use as simple as possible.</p>

 <p>In display client, a friendly matlab GUI  will visualize the receive data. According the motion curve and motion period, we can detect mote’s motion. Thus we can also detect a human motion. It can be used in Video Game, Password Authentication and wild animal tracing.</p>

<hr>

<h3 id="Hardwares">Hardwares</h3>
<img src="../assets/img/Applications_of_Accelerometer/hardware.png" alt="hardware assets" width="500" >
</br>

<table style="width:100%;">

<tr>
<td colspan="3">MPR-Series Mote Hardware Platforms MicaZ</td>
</tr>


<tr>
<td rowspan="3">MCU</td>
<td>Chip</td>
<td>ATMega128L</td>
</tr>


<tr>
<td>Type</td>
<td>7.37 MHz, 8 bit</td>
</tr>


<tr>
<td>Memory (kB)</td>
<td>128</td>
</tr>

<tr>
<td rowspan="2">RF Transceiver (Radio)</td>
<td>Radio Frequency (MHz)</td>
<td>2400</td>
</tr>

<tr>
<td>Max. Data Rate</td>
<td>250 kbits/sec</td>
</tr>

<tr>
<td rowspan="2">Default power source</td>
<td>Type</td>
<td>AA, 2×</td>
</tr>

<tr>
<td>Typical capacity</td>
<td>2000 (mA-hr)</td>
</tr>

</table>
  <P align="center" style="font-size:9pt">Table 1: Details for Platforms MicaZ</p>

<table style="width:100%;">
<tr>
<th colspan="2">Dual-axis Accelerometer</th>
</tr>

<tr>
<td>Analog Devices</td>
<td>ADXL 202JE</td>
</tr>

<tr>
<td>Acceleration Range</td>
<td>±2 g</td>
</tr>

<tr>
<td>Resolution</td>
<td>2mg at 60Hz</td>
</tr>

<tr>
<td>Nonlinearity</td>
<td>0.2% of full scale</td>
</tr>

<tr>
<td>Zero g bias level</td>
<td>2.0mg/ °C from 25°C</td>
</tr>
  </table>
  <P align="center" style="font-size:9pt">Table 2: Details for Accelerometer on MTS400</p>
<hr>

<h3 id="Implementation">Implementation</h3>
<ul>
<li><h4>Mathmetical Model</h4></li>
<p>For the reasons that the TinyOS motes are lite-weighted embeded devices and lack of powerful processors and memories, we need to come up with a alogrithm as simple as possible.From classical physics, we know the relationship between acceleration, velocity and displacement:</p>
  $$ v(t)=\int_0^t a(t)\, \mathrm{d}x $$
  $$ s(t)=\int_0^t v(t)\, \mathrm{d}x $$


<p>As long as we know a(t) , the displacement can be got easily by integral.
In machine realm, the integral is achieved by dividing itself into sum of many little segments:
  $$ v[n]=\sum_{i=0}^{n} a[n]\, \Delta t $$
  $$ s[n]=\sum_{i=0}^{n} v[n]\, \Delta t $$
</p>

<p>In our wireless sensor network (WSN), each mote is attached to a sensor board with an 2-axis accelerometer that can detect the acceleration and convert it into ADC value. Therefore, our decsion is to use this simple integral algorithm to capture the location of the mote each time spot according to the acceleration data from accelerometers. 
</p>

<li><h4>Algorithms</h4></li>
<p>Software layer is implemented by nesC code:
<ol> 
<li>Let the mote itself, based on ADC data, calculate the acceleration (in unit $g$) and velocity (in unit $m/s$) and displacement (in unit $m$) and send data back to base station.
</li>

<li>To get accurate results, the accelerometer must work in a high frequency. We managed to let the mote sample every $5 ms$, which is $200 Hz$ in frequency. This is sufficient for regular common applications. The ADXL202 accelerometer has a maximum bandwidth of $6 kHz$, the frequency is mainly constrained by the calculation speed of MCU.
</li>

<li>In order to solve the noise (instability) problem, we set a threshold, if $|a| < threshold $, force $v$ to zero.
</li>

<li>The result of calculation is a 3 floating point number, and sending packet is binary. So after calculation, a more procedure is applied to convert floating point numbers to binary.
</li>

</ol>
</p>

</br>
<img src="../assets/img/Applications_of_Accelerometer/flowchart.png" alt="flowchart", width="500px">
 <P align="center" style="font-size:9pt">Figure 1: Flow Chart for the Algorithm</p>
<p>The WSN cannot afford high frequency (~$100Hz$) data sending and receiving, our experiment confirmed this and if the frequency exceeds some certain value, a lot of error packet is inevitable. So we set a counter to pick the data for sending and reduced transmit frequency to ~$10Hz$.</p>
<p>In base station, the received data will be $a_x,a_y,v_x,v_y,s_x,s_y$, which can be used in many applications. We use acceleration to determine the tilt angel of the mote, displacement to draw the path of mote and the period of motion. Based on xlisten.m, we built GUI for plotting and reading data.</p>
<li><h4>GUI in MatLab</h4></li>
<p>In order to demonstrate our project more clearly and easily, we use Matlab to design and accomplish a GUI. GUI design of Matlab is friendly to programmer because of using handle to control the figures. In our GUI, we divide the panel to 4 main parts, nearly the axes which is used for showing the motion of our motes, the button group which contains the start and stop button, the setting part on which we can set some configuration of our COM and rate, and the result window that is used for indicating some calculating data of our motes. </p>
<p>For more details: Firstly, start and stop buttons are easy for us to control our demonstration. What`s more, we can easily choose what to draw on the axes and which mote we want to choose by using the radio buttons and checkbox buttons. Also we can set our COM and rate as we wish. At last, the result window can let us comfortably observe the data of our each mote and the motion period.</p>

</ul>
<hr>

<h3 id="Results">Results</h3>
<ul>

<li><h4>Setting:</h4></li>
<ul>
<li type="circle"><strong>COM:</strong> specify com port to listen to.</li>
<li type="circle"><strong>Rate:</strong> specify baudrate.</li>
<li type="circle"><strong>Bubble:</strong> change to gradienter view.</li>
<li type="circle"><strong>Motion Curve:</strong> change to motion path view .</li>
<li type="circle"><strong>Checkbox for Motes:</strong> choose the motes you want to focus(support multiple motes).</li>
</ul>


<li><h4>Motion Curve</h4></li>
<img src="../assets/img/Applications_of_Accelerometer/motioncurve.png" alt="motioncurve", width="500px">
<P align="center" style="font-size:9pt">Figure 2: Result of Motion Curve</p>
<p>Coordinate data calculated by mote itself and shown on the screen using Matlab.</p>
<p><strong>Value of X:</strong> Displacement in x-axis</p>
<p><strong>Value of Y:</strong> Displacement in y axis</p>
<p><strong>Period:</strong> Estimated motion period</p>

<li><h4>Bubble Gradientor</h4></li>
<img src="../assets/img/Applications_of_Accelerometer/gradientor.png" alt="gradientor", width="500px">
<P align="center" style="font-size:9pt">Figure 2: Result of Gradientor Simulation</p>
<p>Tilt angel calculated from acceleration data and shown on the screen using Matlab.
</p>
<p><strong>Value of X:</strong> tilt in x-axis $[-90°,90°]$
</p>
<p><strong>Value of Y:</strong> tilt in y-axis $[-90°,90°]$
</p>
<p><strong>Period:</strong> Estimated motion period</p>
</ul>
<hr>

<h3 id="Future">Future</h3>
<p>As far as now, the support to multiple motes is not perfect, mainly due to the interference of signals in high frequency.</p>
Limited by 2-axis accelerometer, we can only detect 2-dimension motion and period. If <p>we have 3-axis accelerometer combined with gyroscope, we can get the coordinate and direction with high-accuracy, and under this circumstance motion capture system is just around the corner. Another interesting idea is to cooperate with GPS system as an a complement. If there is no GPS signal, motion capture system will help to determine the coordinate and direction and implement seamless navigation everywhere.
</p>
<hr>

</div>

<div id="other">
  <h3>Other Posts</h3>
  <ul class="posts">
    <li>
      <span>Oct 2014 »</span><a href="../blog/Build_Website_by_AWS_and_Nginx_2014_9.html"> How to Build Your Own Website by AWS and Nginx</a>
    </li>

   <li>
      <span>Oct 2014 »</span><a href="../blog/Python_version_coding_interview_questions.html"> Python Solutions for Coding Questions</a>
    </li>

   <li>
      <span>Sep 2014 »</span><a href="../blog/project_color_outlier_2014_9.html"> A Color Outlier Algorithm Based on the Markov Model</a>
    </li>

    <li>
      <span>Aug 2014 »</span> <a href="../blog/project_cyber_service_for_smartlighting.html"> The Control Center for Intelligent Lighting System</a>
    </li>

    <li>
      <span>July 2014 »</span> <a href="../blog/project_Lab_Curriculum_for_Computer_Cyber_Security.html">Cyber Security Learning Schedule for the very Beginner</a>
    </li>
    
  </ul>
</div>


  <div style="float: none">
   <div style="float: left"> <a href="../blog/project_color_outlier_2014_9.html">
    <i class="icon-arrow-left"></i></a></div>

   <div style="float: right"> <a href="../blog/Python_version_coding_interview_questions.html">
    <i class="icon-arrow-right"></i></a></div>
  </div>

<hr>

<div id="disqus_thread"></div>

    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'yuguanglicom'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>

    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>




        </div>
      </div>
    </div>
 

    <div class="footer ">
      <div class="disclaimer">
  

  <p>
    © Yuguang Li Copyright 2014
  </p>
</div>

    </div>
    
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45763537-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>



</body></html>